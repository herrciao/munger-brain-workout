<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>èŠ’æ ¼æ€ç¶­æ¨¡å‹è¨“ç·´æ¸¬é©— v1.0</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Noto Sans TC", "Microsoft JhengHei", sans-serif;
      background: #f5f5f0;
      color: #2c2c2c;
      line-height: 1.7;
      min-height: 100vh;
    }

    .container {
      max-width: 720px;
      margin: 0 auto;
      padding: 24px 20px 60px;
    }

    /* â”€â”€ é ‚éƒ¨æ¨™é¡Œ â”€â”€ */
    header {
      text-align: center;
      padding: 40px 0 20px;
      border-bottom: 2px solid #d4d0c8;
      margin-bottom: 32px;
    }
    header h1 {
      font-size: 1.6rem;
      font-weight: 700;
      letter-spacing: 1px;
      margin-bottom: 8px;
    }
    header p {
      font-size: 0.95rem;
      color: #666;
    }
    header .version {
      font-size: 0.75rem;
      color: #aaa;
      margin-top: 6px;
    }

    /* â”€â”€ é€²åº¦æ¢ â”€â”€ */
    .progress-bar {
      background: #e0ddd5;
      border-radius: 6px;
      height: 8px;
      margin-bottom: 28px;
      overflow: hidden;
    }
    .progress-bar .fill {
      background: #4a7c59;
      height: 100%;
      border-radius: 6px;
      transition: width 0.4s ease;
    }
    .progress-text {
      text-align: center;
      font-size: 0.85rem;
      color: #888;
      margin-bottom: 20px;
    }

    /* â”€â”€ é¡Œç›®å¡ç‰‡ â”€â”€ */
    .question-card {
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 10px;
      padding: 28px 24px;
      margin-bottom: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    }
    .question-card .scenario {
      font-size: 1.05rem;
      margin-bottom: 20px;
      line-height: 1.8;
    }
    .question-card .scenario strong {
      color: #4a7c59;
    }

    /* â”€â”€ é¸é … â”€â”€ */
    .options { list-style: none; }
    .options li {
      background: #fafaf7;
      border: 2px solid #e8e5dd;
      border-radius: 8px;
      padding: 14px 18px;
      margin-bottom: 10px;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 0.98rem;
    }
    .options li:hover {
      border-color: #4a7c59;
      background: #f0f5f1;
    }
    .options li.selected {
      border-color: #4a7c59;
      background: #e8f0ea;
    }
    .options li.correct {
      border-color: #4a7c59;
      background: #d4edda;
    }
    .options li.wrong {
      border-color: #c0392b;
      background: #fce4e4;
    }
    .options li.disabled {
      cursor: default;
      opacity: 0.7;
    }
    .options li.disabled:hover {
      border-color: #e8e5dd;
      background: #fafaf7;
    }
    .options li.correct.disabled:hover {
      border-color: #4a7c59;
      background: #d4edda;
    }
    .options li.wrong.disabled:hover {
      border-color: #c0392b;
      background: #fce4e4;
    }

    /* â”€â”€ è§£æå€ â”€â”€ */
    .explanation {
      background: #f9f8f4;
      border-left: 4px solid #4a7c59;
      border-radius: 0 8px 8px 0;
      padding: 20px 22px;
      margin-top: 20px;
      display: none;
      animation: fadeIn 0.3s ease;
    }
    .explanation.show { display: block; }
    .explanation .result-tag {
      font-size: 1.1rem;
      font-weight: 700;
      margin-bottom: 12px;
    }
    .explanation .result-tag.correct { color: #27763a; }
    .explanation .result-tag.wrong { color: #c0392b; }
    .explanation .model-tag {
      display: inline-block;
      background: #4a7c59;
      color: #fff;
      padding: 3px 12px;
      border-radius: 4px;
      font-size: 0.82rem;
      margin-bottom: 10px;
      margin-right: 6px;
    }
    .explanation .model-tag.secondary {
      background: #7a9e7e;
    }
    .explanation .detail {
      font-size: 0.93rem;
      color: #444;
      margin-top: 8px;
      line-height: 1.8;
    }
    .explanation .wrong-reasons {
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px dashed #ccc;
      font-size: 0.88rem;
      color: #666;
    }
    .explanation .wrong-reasons strong {
      color: #555;
    }

    /* â”€â”€ æŒ‰éˆ• â”€â”€ */
    .btn {
      display: inline-block;
      padding: 12px 32px;
      background: #4a7c59;
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.2s;
      margin-top: 16px;
    }
    .btn:hover { background: #3d6a4a; }
    .btn:disabled {
      background: #bbb;
      cursor: not-allowed;
    }
    .btn-center { text-align: center; }

    /* â”€â”€ é–‹å§‹é  & çµæœé  â”€â”€ */
    .start-page, .result-page {
      text-align: center;
      padding: 60px 20px;
    }
    .start-page h2 {
      font-size: 1.4rem;
      margin-bottom: 12px;
    }
    .start-page p {
      color: #666;
      margin-bottom: 8px;
      font-size: 0.95rem;
    }
    .start-page .note {
      font-size: 0.85rem;
      color: #999;
      margin-top: 20px;
      margin-bottom: 24px;
      line-height: 1.6;
    }

    .result-page h2 {
      font-size: 1.5rem;
      margin-bottom: 16px;
    }
    .result-page .score {
      font-size: 3rem;
      font-weight: 800;
      color: #4a7c59;
      margin: 16px 0;
    }
    .result-page .score span {
      font-size: 1.2rem;
      color: #888;
      font-weight: 400;
    }
    .result-page .summary {
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 10px;
      padding: 24px;
      text-align: left;
      margin: 24px 0;
      font-size: 0.93rem;
      line-height: 1.8;
    }
    .result-page .summary h3 {
      margin-bottom: 12px;
      font-size: 1.05rem;
    }
    .result-page .model-list {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 8px;
    }
    .result-page .model-list .tag {
      background: #e8f0ea;
      color: #3d6a4a;
      padding: 4px 10px;
      border-radius: 4px;
      font-size: 0.82rem;
    }
    .result-page .model-list .tag.missed {
      background: #fce4e4;
      color: #a33;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* â”€â”€ RWD â”€â”€ */
    @media (max-width: 480px) {
      .container { padding: 16px 14px 40px; }
      header h1 { font-size: 1.3rem; }
      .question-card { padding: 20px 16px; }
    }
  </style>
</head>
<body>
<div class="container" id="app">
  <!-- ç”± JS æ¸²æŸ“ -->
</div>

<!-- é¡Œåº«ï¼ˆæ¨¡çµ„åŒ–è¼‰å…¥ï¼Œæ–¹ä¾¿ç¶­è­·èˆ‡æ“´å……ï¼‰ -->
<script src="questions/_loader.js"></script>
<script src="questions/01-general.js"></script>
<script src="questions/02-math.js"></script>
<script src="questions/03-systems.js"></script>
<script src="questions/04-physics-bio.js"></script>
<script src="questions/05-psychology.js"></script>
<script src="questions/06-economics-war.js"></script>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  èŠ’æ ¼æ€ç¶­æ¨¡å‹è¨“ç·´æ¸¬é©— v1.0 â€” 2026-02-10
//  é¡Œåº« 100 é¡Œï¼Œæ¯æ¬¡éš¨æ©ŸæŠ½ 20 é¡Œ
//  èª˜é¤Œé¸é …ä¾†æºï¼šKahneman / Eyal / Lindstrom / Greene
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const VERSION = 'v1.0 â€” 2026-02-10';
const QUIZ_SIZE = 20;

// â”€â”€ Fisher-Yates Shuffle â”€â”€
function shuffle(arr) {
  const a = [...arr];
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

// â”€â”€ æ‡‰ç”¨ç‹€æ…‹ â”€â”€
let activeQuiz = [];     // æœ¬è¼ªæŠ½åˆ°çš„ 20 é¡Œ
let currentIndex = 0;
let score = 0;
let answers = [];
let answered = false;

const app = document.getElementById('app');

// â”€â”€ æ¸²æŸ“ header â”€â”€
function headerHTML() {
  return `
    <header>
      <h1>æŸ¥ç†ãƒ»èŠ’æ ¼ æ€ç¶­æ¨¡å‹è¨“ç·´</h1>
      <p>ä»¥ 100 å€‹æ€ç¶­æ¨¡å‹ç‚ºåŸºç¤çš„æƒ…å¢ƒå¼æ¸¬é©—</p>
      <div class="version">${VERSION}ï½œé¡Œåº« ${allQuestions.length} é¡Œï¼Œæ¯æ¬¡éš¨æ©Ÿ ${QUIZ_SIZE} é¡Œ</div>
    </header>
  `;
}

// â”€â”€ æ¸²æŸ“ï¼šé–‹å§‹é  â”€â”€
function renderStart() {
  app.innerHTML = `
    ${headerHTML()}
    <div class="start-page">
      <h2>æ­¡è¿ä¾†åˆ°æ€ç¶­è¨“ç·´å ´</h2>
      <p>é¡Œåº«å…± <strong>${allQuestions.length} é“æƒ…å¢ƒé¡Œ</strong>ï¼Œæ¯æ¬¡éš¨æ©ŸæŠ½å– ${QUIZ_SIZE} é¡Œã€‚</p>
      <p>æ¯ä¸€é¡Œä½œç­”å¾Œï¼Œä½ æœƒçœ‹åˆ°å°æ‡‰çš„èŠ’æ ¼æ€ç¶­æ¨¡å‹èˆ‡è©³ç´°è§£æã€‚</p>
      <p style="margin-top:8px;font-size:0.9rem;color:#888;">éŒ¯èª¤é¸é …æ··å…¥äº† Kahnemanã€Nir Eyalã€Lindstromã€Robert Greene ç­‰ç†è«–ä½œç‚ºèª˜é¤Œï¼Œ<br>å¹«åŠ©ä½ å€åˆ†ã€ŒèŠ’æ ¼é«”ç³» vs å…¶ä»–æµæ´¾ã€ã€‚</p>
      <div class="note">
        é€™ä¸æ˜¯è€ƒè©¦ï¼Œè€Œæ˜¯ä¸€å€‹<strong>ã€Œè¨“ç·´ä½ åœ¨ç¾å¯¦ä¸­ç”¨å°æ€ç¶­æ¨¡å‹ã€</strong>çš„å·¥å…·ã€‚<br>
        é‡é»æ˜¯å½¢æˆæ­£ç¢ºçš„ç›´è¦ºï¼Œè€Œéè¿½æ±‚åˆ†æ•¸ã€‚æ¯æ¬¡é‡ä¾†éƒ½æ˜¯ä¸åŒçš„é¡Œç›®çµ„åˆã€‚
      </div>
      <button class="btn" onclick="startQuiz()">é–‹å§‹è¨“ç·´</button>
    </div>
  `;
}

// â”€â”€ æ¸²æŸ“ï¼šé¡Œç›® â”€â”€
function renderQuestion() {
  const q = activeQuiz[currentIndex];
  const pct = ((currentIndex) / QUIZ_SIZE * 100).toFixed(0);

  app.innerHTML = `
    ${headerHTML()}
    <div class="progress-bar"><div class="fill" style="width:${pct}%"></div></div>
    <div class="progress-text">ç¬¬ ${currentIndex + 1} é¡Œ / å…± ${QUIZ_SIZE} é¡Œ</div>

    <div class="question-card">
      <div class="scenario">${q.scenario}</div>
      <ul class="options" id="optionsList">
        ${q.options.map((opt, i) => `<li data-idx="${i}" onclick="selectOption(${i})">${opt}</li>`).join('')}
      </ul>

      <div class="explanation" id="explanation">
        <div class="result-tag" id="resultTag"></div>
        <div id="modelTags"></div>
        <div class="detail" id="expDetail"></div>
        <div class="wrong-reasons" id="wrongReasons"></div>
      </div>
    </div>

    <div class="btn-center">
      <button class="btn" id="nextBtn" style="display:none" onclick="nextQuestion()">
        ${currentIndex < QUIZ_SIZE - 1 ? 'ä¸‹ä¸€é¡Œ â†’' : 'æŸ¥çœ‹çµæœ'}
      </button>
    </div>
  `;
  answered = false;
}

// â”€â”€ é¸æ“‡é¸é … â”€â”€
function selectOption(idx) {
  if (answered) return;
  answered = true;

  const q = activeQuiz[currentIndex];
  const isCorrect = idx === q.answer;
  if (isCorrect) score++;
  answers.push({ qIndex: currentIndex, selected: idx, correct: isCorrect });

  const lis = document.querySelectorAll('#optionsList li');
  lis.forEach((li, i) => {
    li.classList.add('disabled');
    if (i === q.answer) li.classList.add('correct');
    if (i === idx && !isCorrect) li.classList.add('wrong');
  });

  const expEl = document.getElementById('explanation');
  const tagEl = document.getElementById('resultTag');
  const modelEl = document.getElementById('modelTags');
  const detailEl = document.getElementById('expDetail');
  const wrongEl = document.getElementById('wrongReasons');

  tagEl.textContent = isCorrect ? 'âœ… æ­£ç¢ºï¼' : 'âŒ éŒ¯èª¤';
  tagEl.className = 'result-tag ' + (isCorrect ? 'correct' : 'wrong');

  let tagsHTML = q.models.map(m => `<span class="model-tag">ä¸»è¦æ¨¡å‹ï¼š${m}</span>`).join('');
  if (q.secondaryModels && q.secondaryModels.length > 0) {
    tagsHTML += q.secondaryModels.map(m => `<span class="model-tag secondary">è¼”åŠ©æ¨¡å‹ï¼š${m}</span>`).join('');
  }
  modelEl.innerHTML = tagsHTML;
  detailEl.innerHTML = q.explanation;
  wrongEl.innerHTML = `<strong>ç‚ºä»€éº¼å…¶ä»–é¸é …çœ‹èµ·ä¾†åˆç†ä½†å¯¦éš›ä¸ŠéŒ¯ï¼š</strong><br>${q.wrongReasons}`;

  expEl.classList.add('show');
  document.getElementById('nextBtn').style.display = 'inline-block';

  setTimeout(() => expEl.scrollIntoView({ behavior: 'smooth', block: 'nearest' }), 100);
}

// â”€â”€ ä¸‹ä¸€é¡Œ â”€â”€
function nextQuestion() {
  currentIndex++;
  if (currentIndex < QUIZ_SIZE) {
    renderQuestion();
    window.scrollTo({ top: 0, behavior: 'smooth' });
  } else {
    renderResult();
  }
}

// â”€â”€ æ¸²æŸ“ï¼šçµæœé  â”€â”€
function renderResult() {
  const correctModels = [];
  const wrongModels = [];
  answers.forEach(a => {
    const q = activeQuiz[a.qIndex];
    const allModels = [...q.models, ...(q.secondaryModels || [])];
    if (a.correct) {
      correctModels.push(...allModels);
    } else {
      wrongModels.push(...allModels);
    }
  });

  const uniqueCorrect = [...new Set(correctModels)];
  const uniqueWrong = [...new Set(wrongModels)];

  let level = '';
  if (score >= 18) level = 'ğŸ† èŠ’æ ¼ç´šæ€ç¶­å¤§å¸«â€”â€”ä½ çš„å¤šå…ƒæ¨¡å‹æ ¼å­å·²ç¶“ç›¸ç•¶å®Œå–„ï¼';
  else if (score >= 14) level = 'ğŸ“ˆ å„ªç§€çš„è·¨å­¸ç§‘æ€è€ƒè€…â€”â€”ç¹¼çºŒç·´ç¿’ï¼ŒæŠŠæ¨¡å‹å…§åŒ–ç‚ºç›´è¦ºã€‚';
  else if (score >= 10) level = 'ğŸ” æœ‰æ½›åŠ›çš„ç†æ€§æ±ºç­–è€…â€”â€”å»ºè­°é‡æ–°é–±è®€ç­”éŒ¯é¡Œç›®çš„æ¨¡å‹èªªæ˜ã€‚';
  else level = 'ğŸ“š æ€ç¶­è¨“ç·´æ–°æ‰‹â€”â€”æ²’é—œä¿‚ï¼èŠ’æ ¼èªªã€Œä¸€ç”ŸæŒçºŒå­¸ç¿’ã€ï¼Œç¾åœ¨å°±æ˜¯æœ€å¥½çš„é–‹å§‹ã€‚';

  app.innerHTML = `
    ${headerHTML()}
    <div class="result-page">
      <h2>è¨“ç·´çµæœ</h2>
      <div class="score">${score} <span>/ ${QUIZ_SIZE}</span></div>
      <p>${level}</p>

      <div class="summary">
        <h3>ä½ æŒæ¡å¾—è¼ƒå¥½çš„æ€ç¶­æ¨¡å‹ï¼š</h3>
        <div class="model-list">
          ${uniqueCorrect.length > 0
            ? uniqueCorrect.map(m => `<span class="tag">${m}</span>`).join('')
            : '<span style="color:#999">ï¼ˆç„¡ï¼‰</span>'}
        </div>
      </div>

      <div class="summary">
        <h3>å»ºè­°åŠ å¼·çš„æ€ç¶­æ¨¡å‹ï¼š</h3>
        <div class="model-list">
          ${uniqueWrong.length > 0
            ? uniqueWrong.map(m => `<span class="tag missed">${m}</span>`).join('')
            : '<span style="color:#4a7c59">å…¨éƒ¨ç­”å°ï¼å¤ªå²å®³äº†ã€‚</span>'}
        </div>
      </div>

      <div class="summary" style="font-size:0.88rem;color:#666;">
        <h3>èŠ’æ ¼çš„ä¸€å¥è©±</h3>
        <p>ã€Œä½ ä¸éœ€è¦ä»€éº¼éƒ½æ‡‚ï¼Œä½†å¹¾å€‹çœŸæ­£é‡å¤§çš„ç†å¿µå¯ä»¥è§£æ±ºå¤§éƒ¨åˆ†å•é¡Œã€‚ã€</p>
        <p style="margin-top:8px">æ¯æ¬¡é‡ä¾†éƒ½æ˜¯ä¸åŒçš„ ${QUIZ_SIZE} é¡Œçµ„åˆã€‚æŒçºŒè¨“ç·´ï¼Œç›´åˆ°èŠ’æ ¼çš„æ€ç¶­æ¨¡å‹æˆç‚ºä½ çš„æœ¬èƒ½åæ‡‰ã€‚</p>
      </div>

      <button class="btn" onclick="resetQuiz()">å†ä¾†ä¸€è¼ªï¼ˆéš¨æ©Ÿæ–°é¡Œï¼‰</button>
    </div>
  `;
}

// â”€â”€ æ§åˆ¶ â”€â”€
function startQuiz() {
  activeQuiz = shuffle(allQuestions).slice(0, QUIZ_SIZE);
  currentIndex = 0;
  score = 0;
  answers = [];
  renderQuestion();
}

function resetQuiz() {
  activeQuiz = [];
  currentIndex = 0;
  score = 0;
  answers = [];
  renderStart();
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// â”€â”€ åˆå§‹åŒ– â”€â”€
renderStart();
</script>
</body>
</html>
